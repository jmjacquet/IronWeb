services:
  ironweb:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: ironweb
    restart: unless-stopped
    environment:
      PYTHONUNBUFFERED: 1
      DEBUG: ${DEBUG:-False}
      GUNICORN_WSGI: ${GUNICORN_WSGI:-ggcontable.wsgi:application}
      DB_HOST: ${DB_HOST:-mariadb_ironweb}
      DB_PORT: ${DB_PORT:-3306}
      DB_USER: ${DB_USER}
      DB_PASS: ${DB_PASS}
      SECRET_KEY: ${SECRET_KEY}
      SESSION_COOKIE_NAME: ${SESSION_COOKIE_NAME:-ironweb_session}
      SERVER_EMAIL: ${SERVER_EMAIL}
      DEFAULT_FROM_EMAIL: ${DEFAULT_FROM_EMAIL}
      GUNICORN_WORKERS: ${GUNICORN_WORKERS:-6}
      GUNICORN_THREADS: ${GUNICORN_THREADS:-3}
      GUNICORN_TIMEOUT: ${GUNICORN_TIMEOUT:-120}
      GUNICORN_BIND: ${GUNICORN_BIND:-0.0.0.0:8000}
      COLLECT_STATIC: ${COLLECT_STATIC:-false}
    volumes:
      - ironweb_static:/app/static
      - ironweb_media:/app/media
      - ironweb_logs:/app/logs
    networks:
      - dokploy-network
    # No Traefik labels - routing via dynamic file

volumes:
  ironweb_static:
    driver: local
    name: ironweb_static
  ironweb_media:
    driver: local
    name: ironweb_media
  ironweb_logs:
    driver: local
    name: ironweb_logs

networks:
  dokploy-network:
    external: true